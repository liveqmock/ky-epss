<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="epss.repository.dao.notMyBits.MyProgSubstlInfoMapper">
    <resultMap id="BaseResultMap" type="epss.repository.model.model_show.ProgSubstlInfoShow">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jun 08 03:16:01 CST 2014.
        -->
        <id column="PKID"                      jdbcType="VARCHAR" property="pkid"/>
        <result column="SUBCTT_INFO_PKID"     jdbcType="VARCHAR" property="tkcttInfoPkid"/>
        <result column="ID"                    jdbcType="VARCHAR" property="id"/>
        <result column="STAGE_NO"             jdbcType="VARCHAR" property="stageNo"/>
        <result column="ARCHIVED_FLAG"       jdbcType="CHAR"     property="archivedFlag"/>
        <result column="ORIGIN_FLAG"         jdbcType="CHAR"     property="originFlag"/>
        <result column="FLOW_STATUS"         jdbcType="CHAR"     property="flowStatus"/>
        <result column="FLOW_STATUS_REMARK" jdbcType="CHAR"    property="flowStatusRemark"/>
        <result column="CREATED_BY"          jdbcType="VARCHAR" property="createdBy"/>
        <result column="CREATED_BY_NAME"    jdbcType="VARCHAR" property="createdByName"/>
        <result column="CREATED_TIME"        jdbcType="VARCHAR" property="createdTime"/>
        <result column="UPDATED_BY"          jdbcType="VARCHAR" property="updatedBy"/>
        <result column="UPDATED_BY_NAME"    jdbcType="VARCHAR" property="updatedByName"/>
        <result column="UPDATED_TIME"        jdbcType="VARCHAR" property="updatedTime"/>
        <result column="REC_VERSION"         jdbcType="DECIMAL" property="recVersion"/>
        <result column="ATTACHMENT"          jdbcType="VARCHAR" property="attachment"/>
        <result column="REMARK"               jdbcType="VARCHAR" property="remark"/>
        <result column="TID"                  jdbcType="VARCHAR" property="tid"/>
    </resultMap>
    <select id="getProgSubstlInfoListByFlowStatusBegin_End" parameterType="epss.repository.model.model_show.ProgSubstlInfoShow"
            resultMap="BaseResultMap">
        <![CDATA[
            select
                psi.PKID,
                psi.SUBCTT_INFO_PKID,
                psi.ID,
                psi.STAGE_NO,
                psi.ARCHIVED_FLAG,
                psi.ORIGIN_FLAG,
                psi.FLOW_STATUS,
                psi.FLOW_STATUS_REMARK,
                psi.CREATED_BY,
                (select Max(OPERNAME) from PTOPER where OPERID=psi.CREATED_BY) as CREATED_BY_NAME,
                psi.CREATED_TIME,
                psi.UPDATED_BY,
                (select Max(OPERNAME) from PTOPER where OPERID=psi.UPDATED_BY) as UPDATED_BY_NAME,
                psi.UPDATED_TIME,
                psi.REC_VERSION,
                psi.ATTACHMENT,
                psi.REMARK,
                psi.TID
             from
                PROG_SUBSTL_INFO psi
             where
                (case when #{strFlowStatusBegin} is null then nvl(psi.FLOW_STATUS,' ')
                       else #{strFlowStatusBegin} end) <= nvl(psi.FLOW_STATUS,' ')
             and
                (case when #{strFlowStatusEnd} is null then nvl(psi.FLOW_STATUS,' ')
                       else #{strFlowStatusEnd} end) >= nvl(psi.FLOW_STATUS,' ')
        ]]>
        <if test="id != null and id != ''">
            and psi.ID like CONCAT('%',CONCAT(trim(#{id}),'%'))
        </if>
        <if test="stageNo != null and stageNo != ''">
            and psi.STAGE_NO like CONCAT('%',CONCAT(trim(#{stageNo}),'%'))
        </if>
    </select>

</mapper>